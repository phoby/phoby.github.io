---
title: Docker ì‹œì‘í•˜ê¸°
date: 2019-01-29 01:00 +0900
tags:
  - docker
  - container 
  - docker image
---
# Docker

`Docker`ëŠ” ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•˜ë©´ `ì»¨í…Œì´ë„ˆ(container)` ê¸°ë°˜ì˜ ì˜¤í”ˆì†ŒìŠ¤ ê°€ìƒí™” í”Œë«í¼ì…ë‹ˆë‹¤.
ì¼ë°˜ì ìœ¼ë¡œ ì»¨í…Œì´ë„ˆëŠ” í™”ë¬¼ ìˆ˜ì†¡ìš© ìƒìë¡œ ë¬´ì–¸ê°€ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í¬ê¸°ì™€ ëª¨ì–‘ì´ ê·œê²©í™”ë˜ì–´ ìˆì–´ íŠ¸ë ˆì¼ëŸ¬ë‚˜ ì² ë„ ê·¸ë¦¬ê³  ëŒ€í˜• ì„ ë°•ì„ í†µí•´ ë¬¼ê±´ì„ ìš´ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì²˜ëŸ¼, ì»¨í…Œì´ë„ˆ ê¸°ë°˜ì´ë¼ëŠ” ê²ƒì€ ì»¨í…Œì´ë„ˆì™€ ê°™ì´ ê·œê²©í™”ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ì—¬ ê·¸ ì•ˆì—ì„œ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ ë˜ëŠ” ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê°€ìƒí™” ê¸°ìˆ ì…ë‹ˆë‹¤. 

## Docker image
`Docker image`ëŠ” `Docker container`ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ë ˆì´ì–´ë¡œ êµ¬ì„±ëœ íŒŒì¼ì…ë‹ˆë‹¤. ì´ê²ƒì€ ISO íŒŒì¼ê³¼ ìœ ì‚¬í•œ ê°œë…ì´ë¼ê³  ìƒê°í•˜ë©´ ì¢€ ì´í•´í•˜ê¸° ì‰¬ìš´ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

(ì°¸ê³ : [ë””ìŠ¤í¬ ì´ë¯¸ì§€](https://ko.wikipedia.org/wiki/%EB%94%94%EC%8A%A4%ED%81%AC_%EC%9D%B4%EB%AF%B8%EC%A7%80))

# Docker ì„¤ì¹˜ 
í…ŒìŠ¤íŠ¸ í™˜ê²½
   - macOS Mojave 10.14.2
   - Homebrew 1.9.2

Docker ì„¤ì¹˜ë¥¼ ìœ„í•´ ì•„ë˜ ëª…ë ¹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

``` shell
$ brew cask install docker

==> Satisfying dependencies
==> Downloading https://download.docker.com/mac/stable/30215/Docker.dmg
######################################################################## 100.0%
==> Verifying SHA-256 checksum for Cask 'docker'.
==> Installing Cask docker
==> Moving App 'Docker.app' to '/Applications/Docker.app'.
ğŸº  docker was successfully installed!
```

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´, `/Application/Docker.app` ì•±ì´ ìƒì„±ë©ë‹ˆë‹¤.

![D5EEF7C6-8A9A-477C-8774-FCA5D7EB743B.png](quiver-image-url/58100FAC68826587AFFB8D0C055C2C53.jpg =640x273)

`Docker.app`ì„ ë‘ë²ˆ í´ë¦­í•´ì„œ Dockerë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.

ê·¸ëŸ¬ë©´, Docker í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ë©´ì„œ ë©”ë‰´ë°”ì—ì„œ ê³ ë˜(?) ëª¨ì–‘ì˜ Docker ì•„ì´ì½˜ì´ í™œì„±í™”ë©ë‹ˆë‹¤.

![6687EFC2-0FFC-4FA3-AB00-1641757F8599.png](quiver-image-url/0F9C42B357F48AA5C9122BD9A6B5CFE5.jpg =209x21)

ì„¤ì¹˜ëœ Dockerì˜ ë²„ì „ì„ í™•ì¸í•©ë‹ˆë‹¤.

``` shell
$ docker --version
Docker version 18.09.1, build 4c52b90

$ docker-compose --version
docker-compose version 1.23.2, build 1110ad01

$ docker-machine --version
docker-machine version 0.16.1, build cce350d7
```

# ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰

í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ê°„ë‹¨í•œ ì›¹ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œì¼œ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì›¹ ì„œë²„ê°€ ë¡œì»¬ì—ì„œ ë°œê²¬ë˜ì§€ ì•Šìœ¼ë©´ `Docker Hub`ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.

> `Docker Hub`ëŠ” Docker ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì €ì¥ ë° ë°°í¬í•˜ëŠ” í´ë¼ìš°ë“œ ê¸°ë°˜ ì €ì¥ì†Œì…ë‹ˆë‹¤. 

``` shell
# docker run :ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ë¼ëŠ” ëª…ë ¹
# --detach : ì‹¤í–‰ë˜ëŠ” ì»¨í„°ì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•˜ê³  ì»¨í…Œì´ë„ˆ IDë¥¼ ì¶œë ¥
# --publish=80:80 : í˜¸ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” port:ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” portë¥¼ 80:80 ìœ¼ë¡œ ë°œí–‰
#                   host:80 -> container:80
# --name : docker image 'nginx'ë¥¼ 'webserver'ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í• ë‹¹
$ docker run --detach --publish=80:80 --name=webserver nginx

Unable to find image 'nginx:latest' locally   # nginx:latest ë²„ì „ ì´ë¯¸ì§€ê°€ ë¡œì»¬ì— ì—†ìœ¼ë¯€ë¡œ
latest: Pulling from library/nginx            # Docker hubì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
5e6ec7f28fb7: Pull complete
ab804f9bbcbe: Pull complete
052b395f16bc: Pull complete
Digest: sha256:4c47bf32cd72eaa779f051e3a077d3ed160e18b8e0dbaf1f705027d8ea6be5c8
Status: Downloaded newer image for nginx:latest
b96ace6157484deab4d9001fb7de2858b1f70323f9e85bbc54efebf2380c1f12
```

ì»¨í…Œì´ë„ˆê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ `docker ps` ë˜ëŠ” `docker container ls` ëª…ë ¹ìœ¼ë¡œ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.

``` shell
$ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   9 minutes ago       Up 9 minutes        0.0.0.0:80->80/tcp   webserver
```
ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í–ˆìœ¼ë‹ˆ ì›¹ ì„œë²„ê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ë„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³  `http://localhost/` ë¡œ ì´ë™í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ nginx í™ˆí˜ì´ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<p align="center">
  <img src="/images/2019-01-29-docker-run-nginx.png">
</p>

## ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒ
`docker container ls` ë˜ëŠ” `docker ps` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
$ docker container ls
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   3 days ago          Up 3 days           0.0.0.0:80->80/tcp   webserver
```

ì‹¤í–‰ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ëª¨ë“  ì»¨í…Œì´ë„ˆ ëª©ë¡ì€ `-a` ë˜ëŠ” `--all` ì˜µì…˜ì„ ì¶”ê°€í•˜ì—¬ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
$ docker container ls -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                     PORTS               NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   3 days ago          Up 9 seconds                                   webserver
5c8cbfa6b1a3        hello-world         "/hello"                 3 days ago          Exited (0) 3 days ago                          awesome_mclaren
```

## ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
`docker container stop {container.name}` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰ì¤‘ì¸ ì»¨í„°ì´ë„ˆë¥¼ ì‹¤í–‰ì„ ì¤‘ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
$ docker container stop webserver
webserver

# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆê°€ ì¡°íšŒë˜ì§€ ì•ŠìŒ
$ docker container ls
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
```

`docker container ls -a` ëª…ë ¹ìœ¼ë¡œ `webserver` ì»¨í…Œì´ë„ˆê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì§€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
``` shell
$ docker container ls -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                     PORTS               NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   3 days ago          Exited (0) 2 minutes ago                       webserver
5c8cbfa6b1a3        hello-world         "/hello"                 3 days ago          Exited (0) 3 days ago                          awesome_mclaren
```

## ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
ì‹¤í–‰ ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆë¥¼ `docker container start {container.name}` ëª…ë ¹ìœ¼ë¡œ ë‹¤ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
$ docker container start webserver
webserver

$ docker container ls -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                  PORTS                  NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   3 days ago          Up 9 minutes            0.0.0.0:80->80/tcp   webserver
5c8cbfa6b1a3        hello-world         "/hello"                 3 days ago          Exited (0) 3 days ago                          awesome_mclaren
```

## ì»¨í…Œì´ë„ˆ ì œê±°
`docker container rm {container.name}` ëª…ë ¹ìœ¼ë¡œ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë‹¨, ì»¨í…Œì´ë„ˆ ì œê±°ë¥¼ ìœ„í•´ì„œëŠ” ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ì¤‘ì§€ ìƒíƒœì—¬ì•¼ í•©ë‹ˆë‹¤.

``` shell
$ docker container rm awesome_mclaren
awesome_mclaren

$ docker container ls -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
5c17b6cbcddd        nginx               "nginx -g 'daemon ofâ€¦"   3 days ago          Up 13 minutes       0.0.0.0:8080->80/tcp   webserver
```

## ì´ë¯¸ì§€ ì œê±°
ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ `docker image rm {image.name}` ëª…ë ¹ìœ¼ë¡œ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
# ì„¤ì¹˜ëœ ëª¨ë“  ì´ë¯¸ì§€ ëª©ë¡ ì¡°íšŒ
$ docker images     
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
nginx               latest              42b4762643dc        5 days ago          109MB
hello-world         latest              fce289e99eb9        3 weeks ago         1.84kB
```

ì¡°íšŒëœ ì´ë¯¸ì§€ ëª©ë¡ì—ì„œ 'nginx' ì´ë¯¸ì§€ë¥¼ ì œê±°í•©ë‹ˆë‹¤.

``` shell
$ docker image rm nginx

Untagged: nginx:latest
Untagged: nginx@sha256:4c47bf32cd72eaa779f051e3a077d3ed160e18b8e0dbaf1f705027d8ea6be5c8
Deleted: sha256:42b4762643dcc9bf492b08064b55fef64942f055f0da91289a8abf93c6d6b43c
Deleted: sha256:e0e55dd2303b3e3ec852acae267d1f8a3eea27a22c64a5829304ecee4d3f559c
Deleted: sha256:4062cf272cdd99e83b1c21f712e5e1359c91ecf92925e56c62133c3324b84e45
Deleted: sha256:3c816b4ead84066ec2cadec2b943993aaacc3fe35fcd77ada3d09dc4f3937313
```

ë§Œì•½, ì»¨í…Œì´ë„ˆê°€ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì°¸ì¡°í•˜ê³  ìˆë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ ì´ë¯¸ì§€ ì œê±° ì‹œ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.
ì»¨í…Œì´ë„ˆë¥¼ ë¨¼ì € ì œê±°í•˜ê±°ë‚˜ `-f` ë˜ëŠ” `--force` ì˜µì…˜ì„ ì¶”ê°€í•´ì„œ ê°•ì œì ìœ¼ë¡œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
$ docker image rm nginx
Error response from daemon: conflict: unable to remove repository reference "nginx" (must force) - container 5c17b6cbcddd is using its referenced image 42b4762643dc
```

# ì •ë¦¬
ì—¬ê¸°ê¹Œì§€ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ `docker`ì˜ ì„¤ì¹˜, ì‹¤í–‰ ëª…ë ¹ì–´ë“¤ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.
ì•ìœ¼ë¡œ, ì—¬ëŸ¬ê°€ì§€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ `docker`ì—ì„œ ì‹¤í–‰í•˜ê³ , ê´€ë¦¬í•˜ëŠ” ê²ƒë“¤ì„ ì •ë¦¬í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

# ì°¸ê³ 
* https://docs.docker.com/
* http://avilos.codes/infra-management/virtualization-platform/docker/what-is-docker-image/
* http://www.opennaru.com/open-source/containers-metaphor-for-what-docker-is/
